node {
    checkout scm
    buildlib = load("pipeline-scripts/buildlib.groovy")
    commonlib = buildlib.commonlib

    properties( [
        buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '100', daysToKeepStr: '', numToKeepStr: '100')),
        disableConcurrentBuilds(),
        disableResume(),
    ] )

    for ( version in commonlib.ocp4Versions ) {
        if (!commonlib.is_prerelease(version)) { // Skip pre-release
            def cv = "${version}" // make sure we use a locally scoped variable

            // Trigger operator-sdk-sync for ${version}
            timeout(activity: true, time: 30, unit: 'MINUTES') {
                build job: '../aos-cd-builds/build%2Foperator-sdk_sync', parameters: [string(name: 'BUILD_VERSION', value: "${cv}")], propagate: false
            }
        }
    }
}